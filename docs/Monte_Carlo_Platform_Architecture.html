<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monte Carlo Simulation Platform - Architecture Documentation</title>
    <style>
        @media print {
            body { font-size: 12pt; }
            .page-break { page-break-before: always; }
            .no-print { display: none; }
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
        }
        
        .header {
            text-align: center;
            border-bottom: 3px solid #2c3e50;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        
        .header h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header .subtitle {
            color: #7f8c8d;
            font-size: 1.2em;
        }
        
        .metadata {
            background: #ecf0f1;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 30px;
        }
        
        .toc {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }
        
        .toc h2 {
            color: #2c3e50;
            margin-top: 0;
        }
        
        .toc ul {
            list-style-type: none;
            padding-left: 0;
        }
        
        .toc li {
            margin-bottom: 8px;
        }
        
        .toc a {
            color: #3498db;
            text-decoration: none;
            font-weight: 500;
        }
        
        .toc a:hover {
            text-decoration: underline;
        }
        
        h1, h2, h3, h4 {
            color: #2c3e50;
        }
        
        h2 {
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            margin-top: 40px;
        }
        
        h3 {
            color: #e74c3c;
            margin-top: 30px;
        }
        
        .highlight {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 4px;
            padding: 15px;
            margin: 20px 0;
        }
        
        .architecture-box {
            border: 2px solid #3498db;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            background: #f8f9fa;
        }
        
        .tech-stack {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .tech-item {
            background: #ffffff;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .tech-item h4 {
            color: #e74c3c;
            margin-top: 0;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
        }
        
        th, td {
            border: 1px solid #dee2e6;
            padding: 12px;
            text-align: left;
        }
        
        th {
            background: #f8f9fa;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .performance-chart {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .flow-diagram {
            background: #ffffff;
            border: 2px solid #3498db;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            font-family: monospace;
            overflow-x: auto;
        }
        
        .code-block {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            margin: 15px 0;
        }
        
        .gpu-memory {
            background: #27ae60;
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .memory-bar {
            background: #2c3e50;
            height: 30px;
            border-radius: 4px;
            margin: 10px 0;
            position: relative;
            overflow: hidden;
        }
        
        .memory-segment {
            height: 100%;
            float: left;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 12px;
        }
        
        .variables { background: #e74c3c; }
        .results { background: #3498db; }
        .lookup { background: #f39c12; }
        .constants { background: #9b59b6; }
        .forecasting { background: #1abc9c; }
        
        .security-layer {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .api-endpoint {
            background: #34495e;
            color: #ecf0f1;
            padding: 10px;
            border-radius: 4px;
            margin: 5px 0;
            font-family: monospace;
        }
        
        .print-button {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            z-index: 1000;
        }
        
        .print-button:hover {
            background: #2980b9;
        }
    </style>
</head>
<body>
    <button class="print-button no-print" onclick="window.print()">üñ®Ô∏è Print Document</button>
    
    <div class="header">
        <h1>Monte Carlo Simulation Platform</h1>
        <div class="subtitle">Complete Architecture Documentation</div>
    </div>
    
    <div class="metadata">
        <strong>Version:</strong> 2.0 &nbsp;&nbsp;&nbsp;
        <strong>Date:</strong> January 3, 2025 &nbsp;&nbsp;&nbsp;
        <strong>Classification:</strong> Technical Documentation &nbsp;&nbsp;&nbsp;
        <strong>Author:</strong> Development Team
    </div>
    
        <div class="toc">
        <h2>üìã Table of Contents</h2>
        <ul>
            <li><a href="#executive-summary">1. Executive Summary</a></li>
            <li><a href="#system-overview">2. System Overview</a></li>
            <li><a href="#architecture-components">3. Architecture Components</a></li>
            <li><a href="#ultra-engine-flow">4. Ultra Engine Internal Flow</a></li>
            <li><a href="#data-flow">5. Data Flow Analysis</a></li>
            <li><a href="#technology-stack">6. Technology Stack</a></li>
            <li><a href="#performance">7. Performance Characteristics</a></li>
            <li><a href="#security">8. Security & Reliability</a></li>
            <li><a href="#developer-guide">9. Developer Guide</a></li>
        </ul>
    </div>
    
    <div class="page-break"></div>
    
    <section id="executive-summary">
        <h2>üìä Executive Summary</h2>
        
        <div class="highlight">
            <h3>üéØ Project Mission</h3>
            <p>Transform static Excel financial models into dynamic, probabilistic analysis tools using GPU-accelerated computation. Deliver enterprise-grade performance with <strong>10-1000x speedup</strong> over traditional CPU-only solutions.</p>
        </div>
        
        <div class="tech-stack">
            <div class="tech-item">
                <h4>üöÄ Key Achievements</h4>
                <ul>
                    <li><strong>Performance:</strong> Process 1M Monte Carlo iterations in under 60 seconds</li>
                    <li><strong>Scale:</strong> Handle Excel files up to 500MB with 1M+ formulas</li>
                    <li><strong>Reliability:</strong> 4-level fallback system ensures 99.9% success rate</li>
                    <li><strong>User Experience:</strong> Real-time progress tracking and instant result visualization</li>
                </ul>
            </div>
            
            <div class="tech-item">
                <h4>üî¨ Technology Innovation</h4>
                <ul>
                    <li><strong>Ultra Engine:</strong> Custom GPU-accelerated simulation engine with CuPy/CUDA</li>
                    <li><strong>Smart Memory Management:</strong> 5 specialized GPU memory pools for optimal allocation</li>
                    <li><strong>Advanced Dependency Analysis:</strong> Handle 100,000+ formula nodes with topological sorting</li>
                    <li><strong>Real-time Architecture:</strong> FastAPI + Redis for sub-second response times</li>
                </ul>
            </div>
        </div>
    </section>
    
    <div class="page-break"></div>
    
    <section id="system-overview">
        <h2>üèóÔ∏è System Overview</h2>
        
        <div class="architecture-box">
            <h3>Core Value Proposition</h3>
            <p>Transform complex Excel financial models into high-performance Monte Carlo simulations with:</p>
            
            <div class="tech-stack">
                <div class="tech-item">
                    <h4>üìà Native Excel Support</h4>
                    <p>Full compatibility with Excel formulas, multi-sheet workbooks, and named ranges</p>
                </div>
                
                <div class="tech-item">
                    <h4>‚ö° GPU Acceleration</h4>
                    <p>Leverage CUDA for 10-1000x performance improvements</p>
                </div>
                
                <div class="tech-item">
                    <h4>üè¢ Enterprise Scale</h4>
                    <p>Process large financial models with millions of calculations</p>
                </div>
                
                <div class="tech-item">
                    <h4>üì± Real-time Feedback</h4>
                    <p>Live progress tracking and immediate result visualization</p>
                </div>
            </div>
        </div>
        
        <h3>üéØ Target Use Cases</h3>
        <ul>
            <li><strong>Financial Risk Analysis:</strong> Portfolio optimization and risk assessment</li>
            <li><strong>Project Valuation:</strong> NPV, IRR, and sensitivity analysis</li>
            <li><strong>Strategic Planning:</strong> Business case modeling with uncertainty</li>
            <li><strong>Regulatory Compliance:</strong> Stress testing and scenario analysis</li>
        </ul>
    </section>
    
    <div class="page-break"></div>
    
    <section id="architecture-components">
        <h2>üèõÔ∏è Architecture Components</h2>
        
        <div class="flow-diagram">
            <h3>System Architecture Overview</h3>
            <pre>
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   FRONTEND      ‚îÇ    ‚îÇ    FASTAPI      ‚îÇ    ‚îÇ  ULTRA ENGINE   ‚îÇ
‚îÇ   (React)       ‚îÇ    ‚îÇ   (Python)      ‚îÇ    ‚îÇ   (GPU/CUDA)    ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§    ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§    ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ ‚Ä¢ File Upload   ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ ‚Ä¢ Upload Parser ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ ‚Ä¢ Dependency    ‚îÇ
‚îÇ ‚Ä¢ Config Setup  ‚îÇ    ‚îÇ ‚Ä¢ Validation    ‚îÇ    ‚îÇ   Analysis      ‚îÇ
‚îÇ ‚Ä¢ Progress View ‚îÇ‚óÄ‚îÄ‚îÄ‚îÄ‚îÇ ‚Ä¢ Background    ‚îÇ‚óÄ‚îÄ‚îÄ‚îÄ‚îÇ ‚Ä¢ GPU Memory    ‚îÇ
‚îÇ ‚Ä¢ Results Viz   ‚îÇ    ‚îÇ   Tasks         ‚îÇ    ‚îÇ   Management    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                       ‚îÇ                       ‚îÇ
         ‚îÇ                       ‚ñº                       ‚ñº
         ‚îÇ              ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
         ‚îÇ              ‚îÇ     REDIS       ‚îÇ    ‚îÇ   POSTGRESQL    ‚îÇ
         ‚îÇ              ‚îÇ   (Caching)     ‚îÇ    ‚îÇ   (Persistence) ‚îÇ
         ‚îÇ              ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§    ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ ‚Ä¢ Progress      ‚îÇ    ‚îÇ ‚Ä¢ Results       ‚îÇ
                        ‚îÇ ‚Ä¢ Results Cache ‚îÇ    ‚îÇ ‚Ä¢ User Data     ‚îÇ
                        ‚îÇ ‚Ä¢ Sessions      ‚îÇ    ‚îÇ ‚Ä¢ Audit Logs    ‚îÇ
                        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
            </pre>
        </div>
        
        <div class="tech-stack">
            <div class="tech-item">
                <h4>üñ•Ô∏è Frontend Layer (React + Redux)</h4>
                <ul>
                    <li><strong>ExcelUpload.jsx:</strong> File upload interface</li>
                    <li><strong>VariableSetup.jsx:</strong> Monte Carlo configuration</li>
                    <li><strong>SimulationProgress.jsx:</strong> Real-time progress view</li>
                    <li><strong>ResultsDisplay.jsx:</strong> Statistical visualization</li>
                </ul>
            </div>
            
            <div class="tech-item">
                <h4>üîå API Layer (FastAPI)</h4>
                <ul>
                    <li><strong>excel_parser/router.py:</strong> File upload & parsing</li>
                    <li><strong>simulation/router.py:</strong> Simulation management</li>
                    <li><strong>auth/router.py:</strong> User authentication</li>
                    <li><strong>admin/router.py:</strong> System administration</li>
                </ul>
            </div>
            
            <div class="tech-item">
                <h4>‚ö° Simulation Engine (Ultra Engine)</h4>
                <ul>
                    <li><strong>UltraMonteCarloEngine:</strong> Main simulation engine</li>
                    <li><strong>GPURandomGenerator:</strong> High-performance RNG</li>
                    <li><strong>DependencyAnalyzer:</strong> Formula graph analysis</li>
                    <li><strong>ResultsDatabase:</strong> Structured data storage</li>
                </ul>
            </div>
            
            <div class="tech-item">
                <h4>üíæ Data Layer</h4>
                <ul>
                    <li><strong>Redis:</strong> Progress tracking, results caching, session management</li>
                    <li><strong>PostgreSQL:</strong> User management, simulation results, audit logs</li>
                </ul>
            </div>
        </div>
    </section>
    
    <div class="page-break"></div>
    
    <section id="ultra-engine-flow">
        <h2>‚ö° Ultra Engine Internal Flow</h2>
        
        <div class="highlight">
            <h3>üéØ Ultra Engine Overview</h3>
            <p>The Ultra Engine is the heart of the Monte Carlo platform, implementing a sophisticated multi-phase GPU-accelerated simulation pipeline. It transforms Excel formulas into high-performance parallel computations with advanced dependency management and error recovery.</p>
        </div>
        
        <div class="flow-diagram">
            <h3>üîß Ultra Engine Processing Pipeline</h3>
            <pre>
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    ULTRA ENGINE INTERNAL FLOW                      ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                                     ‚îÇ
‚îÇ  Phase 1: Engine Initialization (0-5%)                             ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ GPU Capabilities Detection    ‚Üí CUDA/CuPy validation     ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Memory Pool Allocation        ‚Üí 5 specialized pools     ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Random Generator Setup        ‚Üí Deterministic seeding   ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Progress Callback Config      ‚Üí Redis integration       ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                          ‚ñº                                          ‚îÇ
‚îÇ  Phase 2: Workbook Analysis (5-25%)                                ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Parse Excel Workbook          ‚Üí All sheets, formulas    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Multi-Pass Dependency         ‚Üí Complete formula tree   ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Cross-Sheet References        ‚Üí Inter-sheet dependencies‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Circular Detection            ‚Üí Identify loops          ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Topological Sorting           ‚Üí Execution order         ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                          ‚ñº                                          ‚îÇ
‚îÇ  Phase 3: GPU Preparation (25-30%)                                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Memory Allocation             ‚Üí Variables, constants     ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Random Number Generation      ‚Üí CURAND high-performance ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Data Transfer to GPU          ‚Üí Host-to-device copy     ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Kernel Compilation            ‚Üí Custom CUDA functions   ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                          ‚ñº                                          ‚îÇ
‚îÇ  Phase 4: Monte Carlo Execution (30-85%)                           ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Vectorized Batch Processing   ‚Üí Optimal batch sizes     ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Formula Evaluation Pipeline   ‚Üí Dependency-ordered      ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ GPU Kernel Execution          ‚Üí Parallel computation    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Progress Updates              ‚Üí Real-time tracking      ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Error Handling                ‚Üí 4-level fallback        ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                          ‚ñº                                          ‚îÇ
‚îÇ  Phase 5: Results Processing (85-100%)                             ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Statistical Calculation      ‚Üí GPU-accelerated stats    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Histogram Generation          ‚Üí Optimized binning       ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Sensitivity Analysis          ‚Üí Tornado charts          ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Data Transfer to CPU          ‚Üí Device-to-host copy     ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Database Storage              ‚Üí Results persistence     ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
            </pre>
        </div>
        
        <h3>üîÑ Detailed Phase Breakdown</h3>
        
        <div class="tech-stack">
            <div class="tech-item">
                <h4>‚öôÔ∏è Phase 1: Engine Initialization</h4>
                <ul>
                    <li><strong>GPU Detection:</strong> Validate CUDA availability and GPU capabilities</li>
                    <li><strong>Memory Pool Setup:</strong> Pre-allocate 5 specialized GPU memory pools</li>
                    <li><strong>Random Generator:</strong> Initialize deterministic seeding for reproducibility</li>
                    <li><strong>Progress Tracking:</strong> Configure Redis-based progress callbacks</li>
                </ul>
                <div class="code-block">
# Memory Pool Allocation (8GB GPU)
Variables Pool:    3.2GB (40%) - Random variables
Results Pool:      2.4GB (30%) - Simulation outputs  
Lookup Tables:     1.2GB (15%) - VLOOKUP data
Constants Pool:    0.8GB (10%) - Fixed values
Forecasting Pool:  0.4GB (5%)  - Future ML features
                </div>
            </div>
            
            <div class="tech-item">
                <h4>üìä Phase 2: Workbook Analysis</h4>
                <ul>
                    <li><strong>Complete Parsing:</strong> Extract all formulas from all worksheets</li>
                    <li><strong>Dependency Analysis:</strong> Multi-pass formula tree construction</li>
                    <li><strong>Cross-Sheet Support:</strong> Handle inter-sheet formula references</li>
                    <li><strong>Circular Detection:</strong> Identify and resolve circular dependencies</li>
                </ul>
                <div class="code-block">
# Multi-Pass Dependency Analysis
Pass 1: Initial formula extraction
Pass 2: Direct dependencies mapping  
Pass 3: Indirect dependencies discovery
Pass N: Continue until no new dependencies found
Result: Complete directed acyclic graph (DAG)
                </div>
            </div>
            
            <div class="tech-item">
                <h4>üöÄ Phase 3: GPU Preparation</h4>
                <ul>
                    <li><strong>Memory Allocation:</strong> Allocate GPU arrays for all variables</li>
                    <li><strong>Random Generation:</strong> CURAND for high-performance RNG</li>
                    <li><strong>Data Transfer:</strong> Efficient host-to-device memory copy</li>
                    <li><strong>Kernel Setup:</strong> Compile custom financial CUDA kernels</li>
                </ul>
                <div class="code-block">
# GPU Random Number Generation
triangular_values = cp.random.triangular(
    left=min_values,     # Shape: (iterations,)
    mode=likely_values,  # Shape: (iterations,) 
    right=max_values,    # Shape: (iterations,)
    size=iterations
)
# Result: GPU array ready for parallel processing
                </div>
            </div>
            
            <div class="tech-item">
                <h4>‚ö° Phase 4: Monte Carlo Execution</h4>
                <ul>
                    <li><strong>Vectorized Batching:</strong> Process iterations in optimal batch sizes</li>
                    <li><strong>Formula Pipeline:</strong> Execute formulas in dependency order</li>
                    <li><strong>GPU Kernels:</strong> Custom CUDA functions for financial calculations</li>
                    <li><strong>Error Recovery:</strong> 4-level fallback system for reliability</li>
                </ul>
                <div class="code-block">
# Vectorized Formula Evaluation
for batch_idx in range(num_batches):
    # Process batch of iterations in parallel
    batch_results = await self._evaluate_formula_batch(
        formulas=ordered_calc_steps,
        random_values=batch_random_values,
        constants=constant_values
    )
    results.extend(batch_results)
                </div>
            </div>
        </div>
        
        <div class="flow-diagram">
            <h3>üîß Formula Evaluation Pipeline</h3>
            <pre>
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                  FORMULA EVALUATION PIPELINE                       ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                                     ‚îÇ
‚îÇ  Input: Random Variables + Constants + Formula DAG                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ Monte Carlo Variables  ‚îÇ Constant Values  ‚îÇ Formula Tree    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Triangular dist.     ‚îÇ ‚Ä¢ Fixed cells    ‚îÇ ‚Ä¢ Dependencies  ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Normal dist.         ‚îÇ ‚Ä¢ Input params   ‚îÇ ‚Ä¢ Execution     ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Custom dist.         ‚îÇ ‚Ä¢ Lookup tables  ‚îÇ   order         ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                          ‚ñº                                          ‚îÇ
‚îÇ  Formula Processing: Dependency-Ordered Evaluation                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ Level 1: Independent Formulas                               ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Direct calculations      ‚Üí GPU parallel execution        ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Mathematical operations  ‚Üí Vectorized kernels            ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ                                                             ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ Level 2: First-Order Dependencies                          ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Formulas using Level 1   ‚Üí Sequential GPU batches        ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Cross-references         ‚Üí Memory-efficient processing   ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ                                                             ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ Level N: Higher-Order Dependencies                         ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Complex nested formulas  ‚Üí Hierarchical evaluation       ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ VLOOKUP operations       ‚Üí Specialized lookup kernels    ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                          ‚ñº                                          ‚îÇ
‚îÇ  GPU Kernel Execution: Specialized Financial Functions             ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ NPV Calculations         ‚Üí Custom CUDA NPV kernel        ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ IRR Computations         ‚Üí Bisection algorithm on GPU    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Statistical Functions    ‚Üí Parallel percentile calc.     ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Array Operations         ‚Üí Vectorized math operations    ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                          ‚ñº                                          ‚îÇ
‚îÇ  Output: Target Cell Results for Each Iteration                    ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ Results Array: [iteration_1, iteration_2, ..., iteration_N]‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ GPU memory resident      ‚Üí Minimal CPU transfers         ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Real-time progress       ‚Üí Live updates via Redis        ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Error tracking           ‚Üí Iteration-level error logs    ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
            </pre>
        </div>
        
        <div class="gpu-memory">
            <h3>üß† Memory Management Strategy</h3>
            <div class="tech-stack">
                <div class="tech-item">
                    <h4>üéØ Smart Memory Allocation</h4>
                    <ul>
                        <li><strong>Pre-allocation:</strong> Reserve GPU memory before simulation starts</li>
                        <li><strong>Pool Management:</strong> Separate pools for different data types</li>
                        <li><strong>Garbage Collection:</strong> Automatic cleanup of intermediate results</li>
                        <li><strong>Memory Reuse:</strong> Efficient recycling of GPU arrays</li>
                    </ul>
                </div>
                
                <div class="tech-item">
                    <h4>‚ö° Performance Optimizations</h4>
                    <ul>
                        <li><strong>Batch Processing:</strong> Optimal batch sizes for GPU occupancy</li>
                        <li><strong>Kernel Fusion:</strong> Combine operations to reduce memory transfers</li>
                        <li><strong>Asynchronous Processing:</strong> Overlap computation and memory transfers</li>
                        <li><strong>Stream Parallelism:</strong> Multiple CUDA streams for concurrency</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="security-layer">
            <h3>üõ°Ô∏è Error Handling & Fallback System</h3>
            <div class="flow-diagram">
                <pre style="color: white;">
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                     4-LEVEL FALLBACK SYSTEM                        ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                                     ‚îÇ
‚îÇ  Level 1: Ultra GPU Engine (Primary)                               ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ ‚úÖ Full GPU acceleration with CuPy/CUDA                    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚úÖ Custom financial kernels (NPV, IRR)                     ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚úÖ Specialized memory pool management                       ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚úÖ Multi-stream parallel processing                         ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Üí On Success: Continue with maximum performance             ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Üí On GPU Error: Fall back to Level 2                       ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                          ‚ñº (GPU Failure)                           ‚îÇ
‚îÇ  Level 2: Enhanced CPU Engine (Secondary)                          ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ ‚úÖ Optimized NumPy operations                               ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚úÖ Multi-threaded parallel processing                       ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚úÖ Advanced formula evaluation                              ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚úÖ Intelligent batching for memory efficiency               ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Üí On Success: Continue with good performance                ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Üí On Memory Error: Fall back to Level 3                    ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                          ‚ñº (Memory Constraints)                    ‚îÇ
‚îÇ  Level 3: Standard CPU Engine (Tertiary)                           ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ ‚úÖ Basic Monte Carlo simulation                             ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚úÖ Sequential processing for minimal memory                 ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚úÖ Standard formula evaluation                              ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚úÖ Reduced iteration batches                                ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Üí On Success: Continue with basic performance               ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Üí On Critical Error: Fall back to Level 4                  ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                          ‚ñº (Critical Failure)                      ‚îÇ
‚îÇ  Level 4: Graceful Degradation (Final)                             ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ ‚úÖ Partial result return (completed iterations)             ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚úÖ Detailed error reporting and logging                     ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚úÖ System stability maintenance                             ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚úÖ Recovery recommendations for user                        ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚Üí Always succeeds: Returns available results + error info  ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                </pre>
            </div>
        </div>
        
        <div class="performance-chart">
            <h3>üìä Ultra Engine Performance Metrics</h3>
            <table>
                <thead>
                    <tr>
                        <th>Processing Phase</th>
                        <th>Time Allocation</th>
                        <th>GPU Utilization</th>
                        <th>Memory Usage</th>
                        <th>Key Operations</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Initialization</strong></td>
                        <td>0-5%</td>
                        <td>Minimal</td>
                        <td>Memory allocation</td>
                        <td>Setup, validation, pool creation</td>
                    </tr>
                    <tr>
                        <td><strong>Workbook Analysis</strong></td>
                        <td>5-25%</td>
                        <td>None (CPU)</td>
                        <td>Low</td>
                        <td>Parsing, dependency analysis</td>
                    </tr>
                    <tr>
                        <td><strong>GPU Preparation</strong></td>
                        <td>25-30%</td>
                        <td>Medium</td>
                        <td>Data transfer</td>
                        <td>Random generation, memory copy</td>
                    </tr>
                    <tr>
                        <td><strong>Monte Carlo Execution</strong></td>
                        <td>30-85%</td>
                        <td>Maximum</td>
                        <td>Peak usage</td>
                        <td>Formula evaluation, computation</td>
                    </tr>
                    <tr>
                        <td><strong>Results Processing</strong></td>
                        <td>85-100%</td>
                        <td>High</td>
                        <td>Results + stats</td>
                        <td>Statistics, histograms, storage</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </section>
    
    <div class="page-break"></div>
    
    <section id="data-flow">
        <h2>üîÑ Data Flow Analysis</h2>
        
        <div class="flow-diagram">
            <h3>Complete Data Flow Timeline</h3>
            <pre>
TIME    ‚îÇ COMPONENT           ‚îÇ ACTION                    ‚îÇ TECHNOLOGY
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
0s      ‚îÇ Frontend           ‚îÇ User uploads Excel file   ‚îÇ React + FileAPI
+1s     ‚îÇ FastAPI Router     ‚îÇ Receive & validate file   ‚îÇ FastAPI + Upload
+2s     ‚îÇ Excel Parser       ‚îÇ Parse formulas & data     ‚îÇ openpyxl
+3s     ‚îÇ Dependency Analyzer‚îÇ Build formula graph       ‚îÇ CPU + networkx
+5s     ‚îÇ Ultra Engine Init  ‚îÇ Setup GPU memory pools    ‚îÇ CuPy + CUDA
+10s    ‚îÇ Monte Carlo Loop   ‚îÇ Generate random variables ‚îÇ CURAND (GPU)
+30s    ‚îÇ Formula Evaluation ‚îÇ Process all iterations    ‚îÇ GPU Kernels
+45s    ‚îÇ Statistics Calc    ‚îÇ Compute results           ‚îÇ CuPy + NumPy
+50s    ‚îÇ Results Storage    ‚îÇ Save to Redis + DB        ‚îÇ Redis + PostgreSQL
+51s    ‚îÇ Frontend Update    ‚îÇ Display final results     ‚îÇ React + Chart.js
            </pre>
        </div>
        
        <h3>üéØ GPU Utilization Points</h3>
        <div class="gpu-memory">
            <h4>GPU Memory Pool Allocation (8GB Total)</h4>
            <div class="memory-bar">
                <div class="memory-segment variables" style="width: 40%;">Variables 40%</div>
                <div class="memory-segment results" style="width: 30%;">Results 30%</div>
                <div class="memory-segment lookup" style="width: 15%;">Lookup 15%</div>
                <div class="memory-segment constants" style="width: 10%;">Constants 10%</div>
                <div class="memory-segment forecasting" style="width: 5%;">Forecast 5%</div>
            </div>
            
            <ol>
                <li><strong>Memory Pool Allocation:</strong> Pre-allocate 8GB across specialized pools</li>
                <li><strong>Random Number Generation:</strong> CURAND for high-performance RNG</li>
                <li><strong>Formula Evaluation:</strong> Custom CUDA kernels for financial functions</li>
                <li><strong>Statistical Analysis:</strong> GPU-accelerated percentile calculations</li>
            </ol>
        </div>
    </section>
    
    <div class="page-break"></div>
    
    <section id="technology-stack">
        <h2>üõ†Ô∏è Technology Stack</h2>
        
        <h3>Core Technologies</h3>
        <table>
            <thead>
                <tr>
                    <th>Component</th>
                    <th>Technology</th>
                    <th>Version</th>
                    <th>Purpose</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Frontend</strong></td>
                    <td>React</td>
                    <td>18.x</td>
                    <td>User interface framework</td>
                </tr>
                <tr>
                    <td><strong>State Management</strong></td>
                    <td>Redux Toolkit</td>
                    <td>1.9.x</td>
                    <td>Client-side state management</td>
                </tr>
                <tr>
                    <td><strong>API Framework</strong></td>
                    <td>FastAPI</td>
                    <td>0.100.x</td>
                    <td>High-performance async API</td>
                </tr>
                <tr>
                    <td><strong>Simulation Engine</strong></td>
                    <td>Custom Ultra Engine</td>
                    <td>2.0</td>
                    <td>GPU-accelerated Monte Carlo</td>
                </tr>
                <tr>
                    <td><strong>GPU Computing</strong></td>
                    <td>CuPy/CUDA</td>
                    <td>11.x</td>
                    <td>GPU acceleration framework</td>
                </tr>
                <tr>
                    <td><strong>Caching</strong></td>
                    <td>Redis</td>
                    <td>7.x</td>
                    <td>In-memory data structure store</td>
                </tr>
                <tr>
                    <td><strong>Database</strong></td>
                    <td>PostgreSQL</td>
                    <td>15.x</td>
                    <td>Relational data persistence</td>
                </tr>
                <tr>
                    <td><strong>File Processing</strong></td>
                    <td>openpyxl</td>
                    <td>3.1.x</td>
                    <td>Excel file parsing</td>
                </tr>
                <tr>
                    <td><strong>Visualization</strong></td>
                    <td>Chart.js</td>
                    <td>4.x</td>
                    <td>Interactive data visualization</td>
                </tr>
            </tbody>
        </table>
    </section>
    
    <div class="page-break"></div>
    
    <section id="performance">
        <h2>‚ö° Performance Characteristics</h2>
        
        <div class="performance-chart">
            <h3>üìä Monte Carlo Simulation Benchmarks</h3>
            <table>
                <thead>
                    <tr>
                        <th>Iterations</th>
                        <th>CPU Time</th>
                        <th>GPU Time</th>
                        <th>Speedup</th>
                        <th>Memory Usage</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>1K</td>
                        <td>0.1s</td>
                        <td>0.01s</td>
                        <td>10x</td>
                        <td>10MB</td>
                    </tr>
                    <tr>
                        <td>10K</td>
                        <td>1.2s</td>
                        <td>0.05s</td>
                        <td>24x</td>
                        <td>50MB</td>
                    </tr>
                    <tr>
                        <td>100K</td>
                        <td>12.5s</td>
                        <td>0.3s</td>
                        <td>42x</td>
                        <td>200MB</td>
                    </tr>
                    <tr>
                        <td>1M</td>
                        <td>125s</td>
                        <td>1.2s</td>
                        <td>104x</td>
                        <td>1.5GB</td>
                    </tr>
                    <tr>
                        <td>10M</td>
                        <td>1,250s</td>
                        <td>8.7s</td>
                        <td>144x</td>
                        <td>8GB</td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <div class="performance-chart">
            <h3>üìÅ File Processing Performance</h3>
            <table>
                <thead>
                    <tr>
                        <th>File Size</th>
                        <th>Formulas</th>
                        <th>Parsing Time</th>
                        <th>Memory Usage</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>10MB</td>
                        <td>1K</td>
                        <td>0.5s</td>
                        <td>50MB</td>
                    </tr>
                    <tr>
                        <td>50MB</td>
                        <td>10K</td>
                        <td>2.1s</td>
                        <td>200MB</td>
                    </tr>
                    <tr>
                        <td>100MB</td>
                        <td>50K</td>
                        <td>4.8s</td>
                        <td>500MB</td>
                    </tr>
                    <tr>
                        <td>250MB</td>
                        <td>100K</td>
                        <td>12.3s</td>
                        <td>1.2GB</td>
                    </tr>
                    <tr>
                        <td>500MB</td>
                        <td>500K</td>
                        <td>45.2s</td>
                        <td>3.5GB</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </section>
    
    <div class="page-break"></div>
    
    <section id="security">
        <h2>üîê Security & Reliability</h2>
        
        <div class="security-layer">
            <h3>üõ°Ô∏è Security Framework</h3>
            <div class="tech-stack">
                <div class="tech-item">
                    <h4>üîê Authentication</h4>
                    <ul>
                        <li>Auth0 integration ‚Üí Enterprise SSO</li>
                        <li>JWT token validation ‚Üí Stateless auth</li>
                        <li>Role-based access ‚Üí Admin/User separation</li>
                    </ul>
                </div>
                
                <div class="tech-item">
                    <h4>üõ°Ô∏è Data Protection</h4>
                    <ul>
                        <li>File upload validation ‚Üí Malware protection</li>
                        <li>Input sanitization ‚Üí SQL injection prevention</li>
                        <li>Rate limiting ‚Üí DDoS protection</li>
                        <li>Audit logging ‚Üí Security monitoring</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="flow-diagram">
            <h3>üîÑ 4-Level Fallback System</h3>
            <pre>
Level 1: Ultra GPU Engine
    ‚îú‚îÄ GPU acceleration with CuPy/CUDA
    ‚îú‚îÄ Custom financial kernels
    ‚îî‚îÄ Specialized memory management
    
Level 2: Enhanced CPU Engine (on GPU failure)
    ‚îú‚îÄ Optimized NumPy operations
    ‚îú‚îÄ Parallel processing
    ‚îî‚îÄ Advanced formula evaluation
    
Level 3: Standard CPU Engine (on memory constraints)
    ‚îú‚îÄ Basic Monte Carlo simulation
    ‚îú‚îÄ Sequential processing
    ‚îî‚îÄ Minimal memory footprint
    
Level 4: Graceful Degradation (on critical errors)
    ‚îú‚îÄ Partial result return
    ‚îú‚îÄ Error reporting
    ‚îî‚îÄ System stability maintenance
            </pre>
        </div>
    </section>
    
    <div class="page-break"></div>
    
    <section id="developer-guide">
        <h2>üë®‚Äçüíª Developer Guide</h2>
        
        <h3>üöÄ Quick Setup</h3>
        <div class="code-block">
# Clone repository
git clone &lt;repository-url&gt;
cd monte-carlo-platform

# Backend setup
cd backend
pip install -r requirements.txt
python -m uvicorn main:app --reload

# Frontend setup
cd ../frontend
npm install
npm start

# Docker deployment
docker-compose up -d
        </div>
        
        <h3>üîå API Endpoints</h3>
        <div class="api-endpoint">POST /api/excel-parser/upload ‚Üí Upload & parse Excel file</div>
        <div class="api-endpoint">POST /api/simulations/run ‚Üí Start Monte Carlo simulation</div>
        <div class="api-endpoint">GET /api/simulations/{id}/status ‚Üí Get simulation status/results</div>
        <div class="api-endpoint">POST /api/simulations/{id}/cancel ‚Üí Cancel running simulation</div>
        <div class="api-endpoint">GET /api/simulations/history ‚Üí User simulation history</div>
        <div class="api-endpoint">DELETE /api/simulations/{id} ‚Üí Delete simulation data</div>
        
        <h3>üìä Redis Key Patterns</h3>
        <div class="code-block">
simulation:progress:{sim_id}      ‚Üí Progress tracking data
simulation:results:{sim_id}       ‚Üí Cached simulation results  
session:{user_id}                 ‚Üí User session information
rate_limit:{user_id}:{endpoint}   ‚Üí API rate limiting counters
circuit_breaker:health            ‚Üí System health monitoring
cache:file:{file_id}              ‚Üí Parsed Excel file cache
        </div>
        
        <h3>‚öôÔ∏è Configuration</h3>
        <div class="code-block">
# Environment Variables
DATABASE_URL=postgresql://user:pass@localhost/dbname
REDIS_URL=redis://localhost:6379
USE_GPU=true
GPU_MEMORY_FRACTION=0.8
MAX_ITERATIONS=10000000
MAX_FILE_SIZE_MB=500
        </div>
    </section>
    
    <div class="page-break"></div>
    
    <footer style="text-align: center; padding: 20px; border-top: 2px solid #3498db; margin-top: 40px;">
        <p><strong>Document Version:</strong> 2.0 &nbsp;&nbsp;&nbsp; <strong>Last Updated:</strong> January 3, 2025</p>
        <p><em>Monte Carlo Simulation Platform - Technical Documentation Suite</em></p>
    </footer>
    
    <script>
        // Add smooth scrolling for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });
        
        // Add print styles
        const style = document.createElement('style');
        style.textContent = `
            @media print {
                .no-print { display: none !important; }
                body { font-size: 11pt; }
                h1 { font-size: 18pt; }
                h2 { font-size: 14pt; }
                h3 { font-size: 12pt; }
                .page-break { page-break-before: always; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
